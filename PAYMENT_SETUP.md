# 🏦 הוראות הגדרה לסליקת אשראי - נדרים פלוס

## 📋 איך מערכת התשלומים עובדת (לפי התיעוד הרשמי):

### 🔄 תהליך התשלום:
1. **לקוח ממלא טופס** - שם, תעודת זהות, פרטי קשר
2. **לחיצה על "המשך לתשלום"** - נטען iframe ריק
3. **מערכת שולחת נתונים** - PostMessage ל-iframe עם פרטי העסקה
4. **iframe מציג טופס אשראי** - לקוח מזין פרטי כרטיס
5. **סליקה ותוצאה** - iframe מחזיר הצלחה/כשלון

### 🔧 מה תוקן בקוד:

#### ✅ iframe מתחיל ריק:
```html
<iframe src="" frameborder="0" style="display: none;">
```

#### ✅ טעינה נכונה של iframe:
```javascript
// רק אחרי שליחת טופס:
iframe.src = 'https://www.matara.pro/nedarimplus/iframe/';
```

#### ✅ שליחת נתונים בפורמט נכון:
```javascript
const paymentData = {
    'Mosad': 'XXXXXXX',
    'ApiValid': 'XXXXXXXXXX',
    'PaymentType': 'Ragil',
    'Amount': '150',
    'Tashlumim': '1',
    'Currency': '1',
    // + פרטי לקוח
};
```

#### ✅ אימות תעודת זהות ישראלית:
```javascript
function isValidIsraeliID(id) // בדיקת ספרת ביקורת
```

## 📧 קבלת נתוני הרשאה:

**שלח מייל ל:** `office@nedar.im`

**תוכן המייל:**
```
נושא: בקשה לקבלת נתוני API לסליקת אשראי

שלום רב,

אני מעוניין להטמיע מערכת תשלומים באתר שלי עבור:
- שם מוסד: מקוה אומן  
- כתובת אתר: [כתובת האתר שלך]
- סוג עסק: מקוה/שירותים דתיים

אבקש לקבל:
1. מזהה מוסד (7 ספרות)
2. קוד אימות API (10 תווים)

תודה רבה,
[השם שלך]
[טלפון]
```

## ⚙️ הגדרת הקוד:

**בקובץ `app.js` שנה את:**
```javascript
const PAYMENT_CONFIG = {
    mosad: 'כאן 7 ספרות שקיבלת',
    apiValid: 'כאן 10 תווים שקיבלת',
    currency: '1', // 1=שקל, 2=דולר
    paymentType: 'Ragil'
};
```

## 🧪 בדיקת התקנה:

1. **מלא טופס** עם פרטים אמיתיים
2. **לחץ המשך לתשלום** 
3. **בדוק שniframe נטען** עם דף התשלום
4. **בחן בconsole** שאין שגיאות JavaScript
5. **נסה תשלום בדיקה** עם סכום קטן

## � פתרון בעיות:

### ❌ iframe לא נטען:
- בדוק שהמזהה/קוד נכונים
- בדוק שהאתר על HTTPS
- בדוק ב-DevTools אם יש שגיאות

### ❌ אין כפתור תשלום ב-iframe:
- המזהה או קוד שגויים
- הנתונים לא נשלחו נכון ל-iframe
- בדוק ב-Console את הודעות השגיאה

### ❌ "תעודת זהות לא תקינה":
- המערכת בודקת ספרת ביקורת
- השתמש בתעודת זהות אמיתית לבדיקה

## 💡 טיפים חשובים:

- **המתן לטעינה:** iframe צריך זמן להתחבר לשרת
- **נתונים מדויקים:** שגיאה קטנה בפרמטרים = כשלון
- **HTTPS חובה:** מערכת לא עובדת על HTTP
- **בדיקות לוגים:** Console מציג מה קורה ברקע

## 📞 תמיכה טכנית:
- **נדרים פלוס:** office@nedar.im  
- **תיעוד מלא:** https://matara.pro/nedarimplus/ApiDocumentation.html
- **דוגמה רשמית:** https://www.matara.pro/nedarimplus/iframe/sample2.html

---
*עודכן לפי התיעוד הרשמי של נדרים פלוס*
